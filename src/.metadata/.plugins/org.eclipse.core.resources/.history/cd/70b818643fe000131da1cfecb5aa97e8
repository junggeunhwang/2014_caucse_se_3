package model;

import java.util.Vector;
import java.io.*;
import java.util.Stack;
import java.util.ArrayList;

public class ClusterModel extends DsmModel {
	
	public void readCluster(String filePath, int pivot)
	{
		String cluster[][] = new String [2][pivot];
		try
		 {
			File file = new File("after_partitioning_simple.clsx");
			FileInputStream fis = new FileInputStream(file);
			InputStreamReader isr = new InputStreamReader(fis, "UTF-8"); 
			BufferedReader br = new BufferedReader(isr);
			
			String temp="";
			int groupNum=0;
			Stack<String> s = new Stack<String>();
			TreeNode newRoot = new TreeNode();
			while(((temp = br.readLine()) != null)) 
			{
				String[] str= temp.split("\"",3);
				if(str[0].compareTo("<group name=")==0)
				{
					TreeNode newNode = new TreeNode();
					newNode.setKey(str[1]);
					if(groupNum == 0)
					{
						newNode.parent=null;
						newRoot = newNode;
					}
					else
						newRoot.getNode(s.peek()).setChild(newNode);
					s.push(str[1]);
					groupNum++;
				}
				else if(str[0].compareTo("<item name=")==0)
				{
					TreeNode newNode = new TreeNode();
					newNode.setKey(str[1]);
					newRoot.getNode(s.peek()).setChild(newNode);
				}
				else if(str[0].compareTo("</group>")==0)
				{
					groupNum--;
					if(groupNum==0)	break;
					s.pop();
				}
			}
			Vector<TreeNode> tempModules = new Vector<TreeNode>();
			Vector<TreeNode> tempModules2 = new Vector<TreeNode>();
			tempModules = newRoot.getLeafNode(tempModules2);
			updateDepend(tempModules);
			this.setModules(tempModules);
			this.setRoot(newRoot);
		 }
		 catch(FileNotFoundException fnfe){
			 System.out.println("파일을 찾을 수 없습니다.");
			 }catch(IOException ioe){}
	}

	public void writeCluster()
	{
		
	}

}
